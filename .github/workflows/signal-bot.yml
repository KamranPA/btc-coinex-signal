name: CoinEx Signal Bot with Structure Check

on:
  schedule:
    - cron: '*/15 * * * *'  # هر 15 دقیقه اجرا شود
  workflow_dispatch:
    inputs:
      debug_mode:
        description: 'Enable debug mode'
        required: false
        default: 'false'
        type: choice
        options:
        - 'true'
        - 'false'
      test_mode:
        description: 'Enable test mode (no signals sent)'
        required: false
        default: 'false'
        type: choice
        options:
        - 'true'
        - 'false'
      comprehensive_test:
        description: 'Run comprehensive debug test'
        required: false
        default: 'false'
        type: choice
        options:
        - 'true'
        - 'false'

jobs:
  check-structure:
    runs-on: ubuntu-latest
    timeout-minutes: 10
    
    steps:
    - name: Checkout repository
      uses: actions/checkout@v4

    - name: Analyze project structure
      run: |
        echo "🔍 Analyzing project structure..."
        echo ""
        echo "📁 Current working directory: $(pwd)"
        echo ""
        
        echo "📊 Full directory structure:"
        ls -la
        echo ""
        
        echo "🧩 Checking required directories:"
        for dir in services strategies utils config debug logs tests .github/scripts; do
          if [ -d "$dir" ]; then
            echo "✅ Directory exists: $dir"
            echo "   Files in $dir: $(ls -1 $dir | tr '\n' ' ')"
          else
            echo "❌ Directory missing: $dir"
          fi
          echo ""
        done
        
        echo "📄 Checking required files:"
        required_files=(
          "main.py"
          "config/config.py"
          "services/coinex_api.py"
          "services/telegram_bot.py"
          "services/debug_service.py"
          "strategies/mutanabby_strategy.py"
          "utils/error_handler.py"
          "utils/performance_monitor.py"
          "utils/logger.py"
          "requirements.txt"
        )
        
        for file in
