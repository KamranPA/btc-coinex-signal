name: CoinEx Signal Bot

on:
  workflow_dispatch:

jobs:
  check-structure:
    runs-on: ubuntu-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Analyze project structure
        run: |
          echo "ðŸ” ØªØ­Ù„ÛŒÙ„ Ø³Ø§Ø®ØªØ§Ø± Ù¾Ø±ÙˆÚ˜Ù‡..."
          echo ""
          echo "ðŸ“ Ø³Ø§Ø®ØªØ§Ø± Ø¯Ø§ÛŒØ±Ú©ØªÙˆØ±ÛŒ:"
          ls -la
          echo ""
          echo "ðŸ“¦ Ù¾ÙˆØ´Ù‡ services:"
          ls -la services/ 2>/dev/null || echo "âŒ Ù¾ÙˆØ´Ù‡ services ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯"
          echo ""
          echo "âš™ï¸ Ù¾ÙˆØ´Ù‡ config:"
          ls -la config/ 2>/dev/null || echo "âŒ Ù¾ÙˆØ´Ù‡ config ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯"
          echo ""
          echo "ðŸ§ª Ù¾ÙˆØ´Ù‡ tests:"
          ls -la tests/ 2>/dev/null || echo "âŒ Ù¾ÙˆØ´Ù‡ tests ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯"
          echo ""
          echo "ðŸ“„ ÙØ§ÛŒÙ„â€ŒÙ‡Ø§ÛŒ Ù…Ù‡Ù…:"
          echo "main.py: $(if [ -f "main.py" ]; then echo "âœ… ÙˆØ¬ÙˆØ¯ Ø¯Ø§Ø±Ø¯"; else echo "âŒ ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯"; fi)"
          echo "config/config.py: $(if [ -f "config/config.py" ]; then echo "âœ… ÙˆØ¬ÙˆØ¯ Ø¯Ø§Ø±Ø¯"; else echo "âŒ ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯"; fi)"
          echo "requirements.txt: $(if [ -f "requirements.txt" ]; then echo "âœ… ÙˆØ¬ÙˆØ¯ Ø¯Ø§Ø±Ø¯"; else echo "âŒ ÙˆØ¬ÙˆØ¯ Ù†Ø¯Ø§Ø±Ø¯"; fi)"

      - name: Create missing directories
        run: |
          echo "ðŸ“ Ø§ÛŒØ¬Ø§Ø¯ Ù¾ÙˆØ´Ù‡â€ŒÙ‡Ø§ÛŒ Ø¶Ø±ÙˆØ±ÛŒ..."
          mkdir -p services config utils strategies
          echo "âœ… Ù¾ÙˆØ´Ù‡â€ŒÙ‡Ø§ Ø§ÛŒØ¬Ø§Ø¯ Ø´Ø¯Ù†Ø¯"

  run-bot:
    runs-on: ubuntu-latest
    needs: check-structure
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.9'

      - name: Install basic dependencies
        run: |
          echo "ðŸ“¦ Ù†ØµØ¨ dependencies Ù¾Ø§ÛŒÙ‡..."
          pip install requests pandas numpy
          echo "âœ… dependencies Ù†ØµØ¨ Ø´Ø¯Ù†Ø¯"

      - name: Run simple test
        run: |
          echo "ðŸš€ Ø§Ø¬Ø±Ø§ÛŒ ØªØ³Øª Ø³Ø§Ø¯Ù‡..."
          python -c "
print('ðŸ¤– CoinEx Signal Bot - Test Mode')
print('=' * 40)
print('âœ… Python is working correctly')
print('âœ… Basic imports are available')
print('')
print('ðŸ“Š ÙˆØ¶Ø¹ÛŒØª Ø³ÛŒØ³ØªÙ…:')
print('ðŸ”¹ Ø³ÛŒØ³ØªÙ…: Ubuntu Linux')
print('ðŸ”¹ Ù¾Ø§ÛŒØªÙˆÙ†: 3.9')
print('ðŸ”¹ Ù…Ø¹Ù…Ø§Ø±ÛŒ: x64')
print('')
print('ðŸŽ¯ Ø¢Ù…Ø§Ø¯Ù‡ Ø¯Ø±ÛŒØ§ÙØª Ø³ÛŒÚ¯Ù†Ø§Ù„â€ŒÙ‡Ø§...')
          "

      - name: Create success report
        run: |
          echo "âœ… Ø§Ø¬Ø±Ø§ Ù…ÙˆÙÙ‚ÛŒØªâ€ŒØ¢Ù…ÛŒØ² Ø¨ÙˆØ¯" > result.txt
          echo "ðŸ• Ø²Ù…Ø§Ù†: $(date)" >> result.txt
          echo "ðŸ Ù¾Ø§ÛŒØªÙˆÙ†: $(python --version)" >> result.txt
          echo "ðŸ“¦ dependencies: requests, pandas, numpy" >> result.txt

      - name: Upload results
        uses: actions/upload-artifact@v4
        with:
          name: bot-results
          path: result.txt
